# a2sql在各数据集上的实验性能分析报告

## 1. NL2SQL 数据集

### 1.1 第一代版本

1. 问题1
当前版本，我们在dev上的测试结果如下：

'count': 4396, 'exact': 1359, 'acc': 0.3091446769790719


```bash
# 情况1
列名没有加双引号的情况也比较多，提示词里面限制的非常严格，但是仍出现这种情形，后续考虑做SQL生成的后处理#在sql生成的接口中。

example：
SELECT 股价 WHERE 证券简称 == '虎牙直播'	4d28c7ca3aaa11e98617f40f24344a08
SELECT 证券代码, "证券简称", "总市值（亿港元）" WHERE 总市值（亿港元） > 40	4d242e2b3aaa11e98a7ff40f24344a08
```

```bash
# 情况2
评估方式出现的结果偏低问题，

官方评估采用的是SQL语句完全匹配(不考虑顺序)

但实际上会有如下的情形出现：
SELECT MAX ( 11/第22周 ) WHERE 城市 = "北京" or 城市 = "上海"|||SELECT MAX(11/第22周) WHERE 城市 IN ('北京', '上海')
SELECT SUM ( 营业收入(亿元) ) WHERE 时间 = "2013" or 时间 = "2014" or 时间 = "2015"|||SELECT SUM(营业收入(亿元)) WHERE 时间 BETWEEN 2013 AND 2015

这种情况下，无法合理的评估我们系统的好坏。

最终，我们解决以最终SQL执行结果为主，来进行系统的评估。
```


### 1.2 第一代版本终极问题

我们线上测试使用的都是qwen30b-a3b, 但是实际部署环境中我们需要进行模型训练，考虑到显存资源问题，我们需要换成小模型。

对于30b能处理，但小模型无法处理的case，我们先做一手蒸馏，把基础能力蒸馏到小模型里面。

然后再去badcase上进行SFT、DPO、RL训练